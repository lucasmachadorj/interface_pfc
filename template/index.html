<!DOCTYPE html>
<html lang="en">

<head>
    <title>Python Flask Bucket List App</title>


    <link href="http://getbootstrap.com/dist/css/bootstrap.min.css" rel="stylesheet">

    <link href="http://getbootstrap.com/examples/jumbotron-narrow/jumbotron-narrow.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>


</head>

<body>

    <div class="container">
        <div class="header">
            <nav>
                <ul class="nav nav-pills pull-right">
                    <li role="presentation" class="active"><a href="#">Home</a>
                    </li>
                </ul>
            </nav>
            <h3 class="text-muted">PFC - Detecção de botnets</h3>
        </div>

        <!-- <div class="jumbotron"> -->
            <h2>Pesquisar:</h2>
              <div class="col-md-4">
                <form class="form-inline a">
                  <div class="form-group">
                    <label for="ip">endereço IP</label>
                    <input type="text" class="form-control" id="ip" placeholder="192.168.0.1">
                  </div>

                  <div class="form-group">
                    <label for="model">Modelo</label>
                    <input type="text" class="form-control" id="model" placeholder="RBot">
                  </div>

                  <div class="form-group">
                    <label for="date">Data</label>
                    <input type="date" class="form-control" id="date">
                  </div>
              </div>
            </p>
          <hr>
            <br/><br/><br/>
            <div class="col-md-6 col-md-offset-5">
              <button type="button" class="btn btn-default" id="search">Buscar</button>
            </div>
        <!-- </div> -->

        <div class="row marketing">
            <div class="col-lg-12" id="tb">

            </div>
        </div>

        <footer class="footer">
            <p>INSTITUTO MILITAR DE ENGENHARIA</p>
        </footer>
        <script type="text/javascript">
           $(function(){ // I use jQuery in this example
               document.getElementById('search').onclick =
                   function () {
                      var date = $('#date').val();
                      var model = $('#model').val();
                      var ip = $('#ip').val();
                      $.ajax({
                        url: '/search',
                        data: JSON.stringify({model: model, ip: ip, date: date}),
                        contentType: 'application/json;charset=UTF-8',
                        type: 'POST',
                        success: function(response) {
                          console.log(response);
                          var values = $.parseJSON(response);
                          plotTable(values);
                        },
                        error: function(error) {
                          console.log('tchaaaaaaau');
                          console.log(error);
                        }
                      });
                    };
           });

           function plotTable(values){
            $('#tb').append("<table class='table table-hover'><thead><tr><th>Data</th><th>endereço IP</th><th>Modelo</th></tr></thead><tbody id='records_table'></tbody></table>")

             var trHTML = '';
             $.each(values, function (i, item) {
               trHTML += '<tr><td>' + item.date + '</td><td>' + item.addr + '</td><td>' + item.model + '</td></tr>';
             });
            $('#records_table').append(trHTML);
           }
        </script>
    </div>
</body>

</html>
